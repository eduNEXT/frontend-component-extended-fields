{"version":3,"file":"ExtendedProfileProvider.js","names":["_react","_interopRequireWildcard","require","_propTypes","_interopRequireDefault","_ExtendedProfileContext","_service","_utils","_constants","_jsxRuntime","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","ExtendedProfileFieldsProvider","_ref","patchProfile","profileFieldErrors","components","children","extendedProfileFields","setExtendedProfileFields","React","useState","editMode","setEditMode","FORM_MODE","EDITABLE","editingInput","setEditingInput","saveState","setSaveState","useEffect","resv2","getExtendedProfileFieldsV2","fields","sort","moveCheckboxFieldsToEnd","keys","length","EDITING","handleChangeFormMode","mode","fieldName","arguments","undefined","handleSaveExtendedProfile","_ref2","username","params","handleResetFormEdition","handleChangeSaveState","state","value","useMemo","jsx","Provider","propTypes","PropTypes","node","arrayOf","func","objectOf","string","shape","SwitchContent","EmptyContent","EditableItemHeader","_default","exports"],"sources":["../../src/extended-profile/ExtendedProfileProvider.jsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport ExtendedProfileFieldsContext from './ExtendedProfileContext';\nimport { getExtendedProfileFieldsV2 } from './data/service';\n\nimport { moveCheckboxFieldsToEnd } from './utils';\n\nimport { FORM_MODE } from './constants';\n\nconst ExtendedProfileFieldsProvider = ({\n  patchProfile, profileFieldErrors, components, children,\n}) => {\n  const [extendedProfileFields, setExtendedProfileFields] = React.useState();\n  const [editMode, setEditMode] = React.useState(FORM_MODE.EDITABLE);\n  const [editingInput, setEditingInput] = React.useState(null);\n  const [saveState, setSaveState] = React.useState('default');\n\n  React.useEffect(() => {\n    (async () => {\n      const resv2 = await getExtendedProfileFieldsV2();\n      setExtendedProfileFields(resv2.fields.sort(moveCheckboxFieldsToEnd));\n    })();\n  }, []);\n\n  useEffect(() => {\n    if (Object.keys(profileFieldErrors).length) {\n      setSaveState('error');\n      setEditMode(FORM_MODE.EDITING);\n      setEditingInput(Object.keys(profileFieldErrors)[0]);\n    } else {\n      setSaveState('default');\n      setEditMode(FORM_MODE.EDITABLE);\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [Object.keys(profileFieldErrors).length]);\n\n  const handleChangeFormMode = (mode, fieldName = null) => {\n    setEditMode(mode);\n    setEditingInput(fieldName);\n  };\n\n  const handleSaveExtendedProfile = async ({ username, params }) => {\n    if (username) { return patchProfile(username, params); }\n    return patchProfile(params);\n  };\n\n  const handleResetFormEdition = () => {\n    setEditMode(FORM_MODE.EDITABLE);\n    setEditingInput(null);\n    setSaveState('default');\n  };\n\n  const handleChangeSaveState = (state) => {\n    setSaveState(state);\n  };\n\n  const value = React.useMemo(\n    () => ({\n      editMode,\n      extendedProfileFields,\n      editingInput,\n      saveState,\n      profileFieldErrors,\n      handleChangeFormMode,\n      handleResetFormEdition,\n      handleSaveExtendedProfile,\n      handleChangeSaveState,\n      components,\n    }),\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [editMode, editingInput, extendedProfileFields, saveState, Object.keys(profileFieldErrors)],\n  );\n\n  return <ExtendedProfileFieldsContext.Provider value={value}>{children}</ExtendedProfileFieldsContext.Provider>;\n};\n\nExtendedProfileFieldsProvider.propTypes = {\n  children: PropTypes.node || PropTypes.arrayOf(PropTypes.node),\n  patchProfile: PropTypes.func,\n  profileFieldErrors: PropTypes.arrayOf(\n    PropTypes.objectOf(PropTypes.string),\n  ),\n  components: PropTypes.shape({\n    SwitchContent: PropTypes.node,\n    EmptyContent: PropTypes.node,\n    EditableItemHeader: PropTypes.node,\n  }),\n};\n\nexport default ExtendedProfileFieldsProvider;\n"],"mappings":"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","ignoreList":[]}