{"version":3,"file":"BaseField.js","names":["_react","require","_paragon","_i18n","_propTypes","_interopRequireDefault","_messages","_constants","_useFieldController","_ExtendedProfileContext","_jsxRuntime","e","__esModule","default","BaseField","_ref","name","fieldName","value","fieldValue","placeholder","fieldPlaceholder","instructions","fieldInstructions","label","fieldLabel","required","isRequired","restrictions","fieldRestrictions","errorMessages","formEditMode","activeFieldName","setFormMode","handleFormSubmit","saveState","options","fieldOptions","renderEditingField","renderEditableField","renderEmptyField","savingErrors","formatMessage","useIntl","draftValue","setDraftValue","fieldError","getFieldDisplayMode","useFieldController","components","SwitchContent","EmptyContent","EditableItemHeader","useContext","ExtendedProfileFieldsContext","handleStartEditing","FORM_MODE","EDITING","handleCancelEditing","EDITABLE","onSubmit","event","preventDefault","jsx","expression","cases","editing","role","children","jsxs","Form","Group","controlId","isInvalid","className","StatefulButton","type","state","labels","messages","pending","complete","onClick","disabled","Button","variant","editable","empty","Fragment","content","static","propTypes","PropTypes","string","bool","shape","max_length","number","min_length","func","oneOf","arrayOf","defaultProps","STATIC","_default","exports"],"sources":["../../../../src/extended-profile/profile-fields/elements/BaseField.jsx"],"sourcesContent":["import { useContext } from 'react';\nimport { Button, Form, StatefulButton } from '@openedx/paragon';\nimport { useIntl } from '@edx/frontend-platform/i18n';\nimport PropTypes from 'prop-types';\n\nimport messages from '../../messages';\nimport { FORM_MODE } from '../../constants';\n\nimport useFieldController from '../useFieldController';\nimport ExtendedProfileFieldsContext from '../../ExtendedProfileContext';\n\nconst BaseField = ({\n  name: fieldName,\n  value: fieldValue,\n  placeholder: fieldPlaceholder,\n  instructions: fieldInstructions,\n  label: fieldLabel,\n  required: isRequired,\n  restrictions: fieldRestrictions,\n  errorMessages,\n  formEditMode,\n  activeFieldName,\n  setFormMode,\n  handleFormSubmit,\n  saveState,\n  options: fieldOptions,\n  renderEditingField,\n  renderEditableField,\n  renderEmptyField,\n  savingErrors,\n}) => {\n  const { formatMessage } = useIntl();\n\n  const {\n    draftValue, setDraftValue, fieldError, getFieldDisplayMode,\n  } = useFieldController({\n    name: fieldName,\n    value: fieldValue,\n    errorMessages,\n    formEditMode,\n    activeFieldName,\n    fieldRestrictions,\n    savingErrors,\n  });\n\n  const {\n    components: { SwitchContent, EmptyContent, EditableItemHeader },\n  } = useContext(ExtendedProfileFieldsContext);\n\n  const handleStartEditing = () => {\n    setFormMode(FORM_MODE.EDITING, fieldName);\n  };\n\n  const handleCancelEditing = () => {\n    setFormMode(FORM_MODE.EDITABLE);\n    setDraftValue(fieldValue);\n  };\n\n  const onSubmit = async (event) => {\n    event.preventDefault();\n    handleFormSubmit(fieldName, draftValue);\n  };\n\n  return (\n    <SwitchContent\n      expression={getFieldDisplayMode()}\n      cases={{\n        editing: (\n          <div role=\"dialog\" aria-labelledby={`${fieldName}-label`}>\n            <form data-testid=\"field-form\" onSubmit={onSubmit}>\n              <Form.Group controlId={fieldName} isInvalid={fieldError}>\n                {renderEditingField({\n                  fieldName,\n                  fieldLabel,\n                  fieldError,\n                  draftValue,\n                  setDraftValue,\n                  fieldRestrictions,\n                  isRequired,\n                  fieldOptions,\n                })}\n              </Form.Group>\n\n              <div className=\"form-group flex-shrink-0 flex-grow-1\">\n                <StatefulButton\n                  type=\"submit\"\n                  state={saveState}\n                  labels={{\n                    default: formatMessage(messages['profile.formcontrols.button.save']),\n                    pending: formatMessage(messages['profile.formcontrols.button.saving']),\n                    complete: formatMessage(messages['profile.formcontrols.button.saved']),\n                  }}\n                  onClick={(e) => {\n                    if (saveState === 'pending') {\n                      e.preventDefault();\n                    }\n                  }}\n                  disabled={!!fieldError}\n                />\n                <Button variant=\"link\" onClick={handleCancelEditing}>\n                  {formatMessage(messages['profile.formcontrols.button.cancel'])}\n                </Button>\n              </div>\n            </form>\n          </div>\n        ),\n        editable: renderEditableField({\n          fieldLabel,\n          fieldName,\n          draftValue,\n          handleStartEditing,\n        }),\n        empty: renderEmptyField?.({\n          fieldName,\n          fieldLabel,\n          draftValue,\n          fieldInstructions,\n          fieldPlaceholder,\n          handleStartEditing,\n        }) || (\n          <>\n            <EditableItemHeader content={fieldLabel} />\n            <EmptyContent onClick={handleStartEditing}>{fieldInstructions}</EmptyContent>\n            <small className=\"form-text text-muted\">{fieldPlaceholder}</small>\n          </>\n        ),\n        static: draftValue && (\n          <>\n            <EditableItemHeader content={fieldLabel} />\n            <p data-hj-suppress className=\"h5\">\n              {draftValue}\n            </p>\n          </>\n        ),\n      }}\n    />\n  );\n};\n\nBaseField.propTypes = {\n  name: PropTypes.string.isRequired,\n  value: PropTypes.string,\n  placeholder: PropTypes.string,\n  instructions: PropTypes.string,\n  label: PropTypes.string,\n  required: PropTypes.bool,\n  restrictions: PropTypes.shape({\n    max_length: PropTypes.number,\n    min_length: PropTypes.number,\n  }),\n  errorMessages: PropTypes.shape({\n    required: PropTypes.string,\n    max_length: PropTypes.string,\n    min_length: PropTypes.string,\n  }),\n  formEditMode: PropTypes.string,\n  activeFieldName: PropTypes.string,\n  setFormMode: PropTypes.func,\n  handleFormSubmit: PropTypes.func,\n  saveState: PropTypes.oneOf(['default', 'error', 'pending', 'complete']),\n  renderEditingField: PropTypes.func.isRequired,\n  renderEditableField: PropTypes.func.isRequired,\n  renderEmptyField: PropTypes.func,\n  options: PropTypes.arrayOf(\n    PropTypes.shape({\n      value: PropTypes.string.isRequired,\n      label: PropTypes.string.isRequired,\n    }),\n  ),\n};\n\nBaseField.defaultProps = {\n  value: '',\n  placeholder: '',\n  instructions: '',\n  label: '',\n  restrictions: {},\n  errorMessages: {},\n  formEditMode: FORM_MODE.STATIC,\n  activeFieldName: '',\n  setFormMode: () => {},\n  handleFormSubmit: () => {},\n  saveState: 'default',\n  renderEmptyField: null,\n};\n\nexport default BaseField;\n"],"mappings":"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","ignoreList":[]}