{"version":3,"file":"index.js","names":["_react","_interopRequireWildcard","require","_auth","_ExtendedProfileContext","_interopRequireDefault","_TextField","_CheckboxField","_SelectField","_jsxRuntime","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","ownKeys","keys","getOwnPropertySymbols","o","filter","enumerable","push","apply","_objectSpread","arguments","length","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","_toPropertyKey","value","configurable","writable","_toPrimitive","Symbol","toPrimitive","TypeError","String","Number","ProfileFields","_ref","fetchProfile","extendedProfileValues","extendedProfileFields","editMode","formEditMode","editingInput","activeFieldName","handleChangeFormMode","setFormMode","handleSaveExtendedProfile","saveProfile","handleResetFormEdition","handleChangeSaveState","saveState","components","SwitchContent","useContext","ExtendedProfileFieldsContext","savingErrors","setSavingErrors","React","useState","handleFormSubmit","fieldName","fieldValue","user","getAuthenticatedUser","newFields","map","field","username","params","extendedProfile","error","fromEntries","entries","processedData","fieldErrors","_ref2","key","userMessage","jsx","children","find","el","name","commonProps","className","expression","type","cases","checkbox","text","select","_default","exports"],"sources":["../../../src/extended-profile/profile-fields/index.jsx"],"sourcesContent":["import React, { useContext } from 'react';\nimport { getAuthenticatedUser } from '@edx/frontend-platform/auth';\n\nimport ExtendedProfileFieldsContext from '../ExtendedProfileContext';\n\nimport TextField from './elements/TextField';\nimport CheckboxField from './elements/CheckboxField';\nimport SelectField from './elements/SelectField';\n\nconst ProfileFields = ({ fetchProfile, extendedProfileValues }) => {\n  const {\n    extendedProfileFields,\n    editMode: formEditMode,\n    editingInput: activeFieldName,\n    handleChangeFormMode: setFormMode,\n    handleSaveExtendedProfile: saveProfile,\n    handleResetFormEdition,\n    handleChangeSaveState,\n    saveState,\n    components: { SwitchContent },\n  } = useContext(ExtendedProfileFieldsContext);\n\n  const [savingErrors, setSavingErrors] = React.useState({});\n\n  const handleFormSubmit = async (fieldName, fieldValue) => {\n    handleChangeSaveState('pending');\n    const user = getAuthenticatedUser();\n    const newFields = extendedProfileValues.map((field) => {\n      if (field.fieldName === fieldName) {\n        return { ...field, fieldValue };\n      }\n      return field;\n    });\n\n    try {\n      await saveProfile({ username: user.username, params: { extendedProfile: newFields } });\n      fetchProfile(user.username);\n      handleResetFormEdition();\n    } catch (error) {\n      setSavingErrors(\n        Object.fromEntries(\n          Object.entries(error.processedData.fieldErrors)\n            .map(([key, value]) => [key, value.userMessage]),\n        ),\n      );\n      handleChangeSaveState('error');\n    }\n  };\n  return (\n    <div>\n      {extendedProfileFields?.map((field) => {\n        // extendedProfileValues comes from the user profile values\n        // here we are looking for the field value of each extended profile field\n        const value = extendedProfileValues?.find((el) => el.fieldName === field.name)?.fieldValue;\n\n        const commonProps = {\n          ...field,\n          value,\n          formEditMode,\n          activeFieldName,\n          setFormMode,\n          handleFormSubmit,\n          saveState,\n          savingErrors,\n        };\n\n        return (\n          <SwitchContent\n            className=\"mb-5\"\n            expression={field.type}\n            cases={{\n              checkbox: <CheckboxField {...commonProps} />,\n              text: <TextField {...commonProps} />,\n              select: <SelectField {...commonProps} />,\n            }}\n          />\n        );\n      })}\n    </div>\n  );\n};\n\nexport default ProfileFields;\n"],"mappings":"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","ignoreList":[]}