{"version":3,"file":"BaseField.js","names":["_react","require","_paragon","_i18n","_propTypes","_interopRequireDefault","_faPencilAlt","_reactFontawesome","_messages","_constants","_useFieldController","_ExtendedProfileContext","_jsxRuntime","e","__esModule","default","BaseField","_ref","name","fieldName","value","fieldValue","label","fieldLabel","required","isRequired","restrictions","fieldRestrictions","instructions","fieldInstructions","errorMessages","formEditMode","activeFieldName","setFormMode","handleFormSubmit","saveState","options","fieldOptions","renderEditingField","renderEditableField","savingErrors","formatMessage","useIntl","draftValue","setDraftValue","fieldError","getFieldDisplayMode","useFieldController","components","SwitchContent","useContext","ExtendedProfileFieldsContext","handleStartEditing","FORM_MODE","EDITING","handleCancelEditing","DEFAULT","onSubmit","event","preventDefault","renderEmptyLabel","jsxs","Button","variant","onClick","className","children","renderValue","rawValue","jsx","expression","cases","editing","role","Form","Group","controlId","isInvalid","Text","StatefulButton","type","state","labels","messages","pending","complete","disabled","FontAwesomeIcon","icon","faPencilAlt","propTypes","PropTypes","string","bool","shape","max_length","number","min_length","func","oneOf","arrayOf","defaultProps","STATIC","_default","exports"],"sources":["../../../../src/extended-profile/account-fields/elements/BaseField.jsx"],"sourcesContent":["import { useContext } from 'react';\nimport { Button, Form, StatefulButton } from '@openedx/paragon';\nimport { useIntl } from '@edx/frontend-platform/i18n';\nimport PropTypes from 'prop-types';\n\nimport { faPencilAlt } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nimport messages from '../../messages';\nimport { FORM_MODE } from '../../constants';\n\nimport useFieldController from '../useFieldController';\nimport ExtendedProfileFieldsContext from '../../ExtendedProfileContext';\n\nconst BaseField = ({\n  name: fieldName,\n  value: fieldValue,\n  label: fieldLabel,\n  required: isRequired,\n  restrictions: fieldRestrictions,\n  instructions: fieldInstructions,\n  errorMessages,\n  formEditMode,\n  activeFieldName,\n  setFormMode,\n  handleFormSubmit,\n  saveState,\n  options: fieldOptions,\n  renderEditingField,\n  renderEditableField,\n  savingErrors,\n}) => {\n  const { formatMessage } = useIntl();\n\n  const {\n    draftValue, setDraftValue, fieldError, getFieldDisplayMode,\n  } = useFieldController({\n    name: fieldName,\n    value: fieldValue,\n    errorMessages,\n    formEditMode,\n    activeFieldName,\n    fieldRestrictions,\n    savingErrors,\n  });\n\n  const {\n    components: { SwitchContent },\n  } = useContext(ExtendedProfileFieldsContext);\n\n  const handleStartEditing = () => {\n    setFormMode(FORM_MODE.EDITING, fieldName);\n  };\n\n  const handleCancelEditing = () => {\n    setFormMode(FORM_MODE.DEFAULT);\n    setDraftValue(fieldValue);\n  };\n\n  const onSubmit = async (event) => {\n    event.preventDefault();\n    handleFormSubmit(fieldName, draftValue);\n  };\n\n  const renderEmptyLabel = () => (\n    <Button variant=\"link\" onClick={() => handleStartEditing()} className=\"p-0\">Add {fieldLabel}</Button>\n  );\n\n  const renderValue = (rawValue) => {\n    if (!rawValue) {\n      if (renderEditableField) { return null; }\n      return renderEmptyLabel();\n    }\n\n    return rawValue;\n  };\n\n  return (\n    <SwitchContent\n      expression={getFieldDisplayMode()}\n      cases={{\n        editing: (\n          <div role=\"dialog\" aria-labelledby={`${fieldName}-label`}>\n            <form data-testid=\"field-form\" onSubmit={onSubmit}>\n              <Form.Group controlId={fieldName} isInvalid={fieldError}>\n                {renderEditingField({\n                  fieldName,\n                  fieldLabel,\n                  fieldError,\n                  draftValue,\n                  setDraftValue,\n                  fieldRestrictions,\n                  isRequired,\n                  fieldOptions,\n                })}\n                {!!fieldInstructions && <Form.Text>{fieldInstructions}</Form.Text>}\n              </Form.Group>\n\n              <div className=\"form-group flex-shrink-0 flex-grow-1\">\n                <StatefulButton\n                  type=\"submit\"\n                  className=\"mr-2\"\n                  state={saveState}\n                  labels={{\n                    default: formatMessage(messages['profile.formcontrols.button.save']),\n                    pending: formatMessage(messages['profile.formcontrols.button.saving']),\n                    complete: formatMessage(messages['profile.formcontrols.button.saved']),\n                  }}\n                  onClick={(e) => {\n                    if (saveState === 'pending') {\n                      e.preventDefault();\n                    }\n                  }}\n                  disabled={!!fieldError}\n                />\n                <Button variant=\"outline-primary\" onClick={handleCancelEditing}>\n                  {formatMessage(messages['profile.formcontrols.button.cancel'])}\n                </Button>\n              </div>\n            </form>\n          </div>\n        ),\n        default: (\n          <div className=\"form-group\">\n            <div className=\"d-flex align-items-start\">\n              {renderEditableField?.({\n                fieldLabel, fieldName, handleStartEditing, draftValue,\n              }) || <h6 aria-level=\"3\">{fieldLabel}</h6>}\n              <Button variant=\"link\" onClick={handleStartEditing} className=\"ml-3\">\n                <FontAwesomeIcon className=\"mr-1\" icon={faPencilAlt} />{formatMessage(messages['account.settings.editable.field.action.edit'])}\n              </Button>\n            </div>\n            <p data-hj-suppress>{renderValue(draftValue)}</p>\n          </div>\n        ),\n      }}\n    />\n  );\n};\n\nBaseField.propTypes = {\n  name: PropTypes.string.isRequired,\n  value: PropTypes.string,\n  label: PropTypes.string,\n  required: PropTypes.bool,\n  restrictions: PropTypes.shape({\n    max_length: PropTypes.number,\n    min_length: PropTypes.number,\n  }),\n  errorMessages: PropTypes.shape({\n    required: PropTypes.string,\n    max_length: PropTypes.string,\n    min_length: PropTypes.string,\n  }),\n  instructions: PropTypes.string,\n  formEditMode: PropTypes.string,\n  activeFieldName: PropTypes.string,\n  setFormMode: PropTypes.func,\n  handleFormSubmit: PropTypes.func,\n  saveState: PropTypes.oneOf(['default', 'error', 'pending', 'complete']),\n  renderEditingField: PropTypes.func.isRequired,\n  renderEditableField: PropTypes.func,\n  options: PropTypes.arrayOf(\n    PropTypes.shape({\n      value: PropTypes.string.isRequired,\n      label: PropTypes.string.isRequired,\n    }),\n  ),\n};\n\nBaseField.defaultProps = {\n  value: '',\n  label: '',\n  restrictions: {},\n  errorMessages: {},\n  formEditMode: FORM_MODE.STATIC,\n  activeFieldName: '',\n  setFormMode: () => {},\n  handleFormSubmit: () => {},\n  saveState: 'default',\n};\n\nexport default BaseField;\n"],"mappings":"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","ignoreList":[]}