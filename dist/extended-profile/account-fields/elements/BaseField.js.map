{"version":3,"file":"BaseField.js","names":["_react","require","_paragon","_i18n","_propTypes","_interopRequireDefault","_faPencilAlt","_reactFontawesome","_messages","_constants","_useFieldController","_ExtendedProfileContext","_jsxRuntime","e","__esModule","default","BaseField","_ref","name","fieldName","value","fieldValue","label","fieldLabel","required","isRequired","restrictions","fieldRestrictions","instructions","fieldInstructions","errorMessages","formEditMode","activeFieldName","setFormMode","handleFormSubmit","saveState","options","fieldOptions","renderEditingField","renderEditableField","savingErrors","formatMessage","useIntl","draftValue","setDraftValue","fieldError","getFieldDisplayMode","useFieldController","components","SwitchContent","useContext","ExtendedProfileFieldsContext","handleStartEditing","FORM_MODE","EDITING","handleCancelEditing","DEFAULT","onSubmit","event","preventDefault","renderEmptyLabel","jsx","Button","variant","onClick","className","children","messages","renderValue","rawValue","fieldOption","find","option","expression","cases","editing","role","jsxs","Form","Group","controlId","isInvalid","Text","StatefulButton","type","state","labels","pending","complete","disabled","FontAwesomeIcon","icon","faPencilAlt","propTypes","PropTypes","string","bool","shape","max_length","number","min_length","func","oneOf","arrayOf","defaultProps","STATIC","_default","exports"],"sources":["../../../../src/extended-profile/account-fields/elements/BaseField.jsx"],"sourcesContent":["import { useContext } from 'react';\nimport { Button, Form, StatefulButton } from '@openedx/paragon';\nimport { useIntl } from '@edx/frontend-platform/i18n';\nimport PropTypes from 'prop-types';\n\nimport { faPencilAlt } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\n\nimport messages from '../../messages';\nimport { FORM_MODE } from '../../constants';\n\nimport useFieldController from '../useFieldController';\nimport ExtendedProfileFieldsContext from '../../ExtendedProfileContext';\n\nconst BaseField = ({\n  name: fieldName,\n  value: fieldValue,\n  label: fieldLabel,\n  required: isRequired,\n  restrictions: fieldRestrictions,\n  instructions: fieldInstructions,\n  errorMessages,\n  formEditMode,\n  activeFieldName,\n  setFormMode,\n  handleFormSubmit,\n  saveState,\n  options: fieldOptions,\n  renderEditingField,\n  renderEditableField,\n  savingErrors,\n}) => {\n  const { formatMessage } = useIntl();\n\n  const {\n    draftValue, setDraftValue, fieldError, getFieldDisplayMode,\n  } = useFieldController({\n    name: fieldName,\n    value: fieldValue,\n    errorMessages,\n    formEditMode,\n    activeFieldName,\n    fieldRestrictions,\n    savingErrors,\n  });\n\n  const {\n    components: { SwitchContent },\n  } = useContext(ExtendedProfileFieldsContext);\n\n  const handleStartEditing = () => {\n    setFormMode(FORM_MODE.EDITING, fieldName);\n  };\n\n  const handleCancelEditing = () => {\n    setFormMode(FORM_MODE.DEFAULT);\n    setDraftValue(fieldValue);\n  };\n\n  const onSubmit = async (event) => {\n    event.preventDefault();\n    handleFormSubmit(fieldName, draftValue);\n  };\n\n  const renderEmptyLabel = () => (\n    <Button variant=\"link\" onClick={() => handleStartEditing()} className=\"p-0\">\n      {formatMessage(messages['account.settings.editable.field.action.add'], { fieldLabel })}\n    </Button>\n  );\n\n  const renderValue = (rawValue) => {\n    if (!rawValue) {\n      if (renderEditableField) { return null; }\n      return renderEmptyLabel();\n    }\n\n\t// If it is a select field, we want to display the option label instead of the value\n\tconst fieldOption = fieldOptions?.find((option) => option.value === rawValue);\n    return fieldOption ? fieldOption.name : rawValue;\n  };\n\n  return (\n    <SwitchContent\n      expression={getFieldDisplayMode()}\n      cases={{\n        editing: (\n          <div role=\"dialog\" aria-labelledby={`${fieldName}-label`}>\n            <form data-testid=\"field-form\" onSubmit={onSubmit}>\n              <Form.Group controlId={fieldName} isInvalid={fieldError}>\n                {renderEditingField({\n                  fieldName,\n                  fieldLabel,\n                  fieldError,\n                  draftValue,\n                  setDraftValue,\n                  fieldRestrictions,\n                  isRequired,\n                  fieldOptions,\n                })}\n                {!!fieldInstructions && <Form.Text>{fieldInstructions}</Form.Text>}\n              </Form.Group>\n\n              <div className=\"form-group flex-shrink-0 flex-grow-1\">\n                <StatefulButton\n                  type=\"submit\"\n                  className=\"mr-2\"\n                  state={saveState}\n                  labels={{\n                    default: formatMessage(messages['profile.formcontrols.button.save']),\n                    pending: formatMessage(messages['profile.formcontrols.button.saving']),\n                    complete: formatMessage(messages['profile.formcontrols.button.saved']),\n                  }}\n                  onClick={(e) => {\n                    if (saveState === 'pending') {\n                      e.preventDefault();\n                    }\n                  }}\n                  disabled={!!fieldError}\n                />\n                <Button variant=\"outline-primary\" onClick={handleCancelEditing}>\n                  {formatMessage(messages['profile.formcontrols.button.cancel'])}\n                </Button>\n              </div>\n            </form>\n          </div>\n        ),\n        default: (\n          <div className=\"form-group\">\n            <div className=\"d-flex align-items-start\">\n              {renderEditableField?.({\n                fieldLabel, fieldName, handleStartEditing, draftValue,\n              }) || <h6 aria-level=\"3\">{fieldLabel}</h6>}\n              <Button variant=\"link\" onClick={handleStartEditing} className=\"ml-3\">\n                <FontAwesomeIcon className=\"mr-1\" icon={faPencilAlt} />{formatMessage(messages['account.settings.editable.field.action.edit'])}\n              </Button>\n            </div>\n            <p data-hj-suppress>{renderValue(draftValue)}</p>\n          </div>\n        ),\n      }}\n    />\n  );\n};\n\nBaseField.propTypes = {\n  name: PropTypes.string.isRequired,\n  value: PropTypes.string,\n  label: PropTypes.string,\n  required: PropTypes.bool,\n  restrictions: PropTypes.shape({\n    max_length: PropTypes.number,\n    min_length: PropTypes.number,\n  }),\n  errorMessages: PropTypes.shape({\n    required: PropTypes.string,\n    max_length: PropTypes.string,\n    min_length: PropTypes.string,\n  }),\n  instructions: PropTypes.string,\n  formEditMode: PropTypes.string,\n  activeFieldName: PropTypes.string,\n  setFormMode: PropTypes.func,\n  handleFormSubmit: PropTypes.func,\n  saveState: PropTypes.oneOf(['default', 'error', 'pending', 'complete']),\n  renderEditingField: PropTypes.func.isRequired,\n  renderEditableField: PropTypes.func,\n  options: PropTypes.arrayOf(\n    PropTypes.shape({\n      value: PropTypes.string.isRequired,\n      label: PropTypes.string.isRequired,\n    }),\n  ),\n};\n\nBaseField.defaultProps = {\n  value: '',\n  label: '',\n  restrictions: {},\n  errorMessages: {},\n  formEditMode: FORM_MODE.STATIC,\n  activeFieldName: '',\n  setFormMode: () => {},\n  handleFormSubmit: () => {},\n  saveState: 'default',\n};\n\nexport default BaseField;\n"],"mappings":"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","ignoreList":[]}