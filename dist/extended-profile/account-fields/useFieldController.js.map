{"version":3,"file":"useFieldController.js","names":["_react","require","_i18n","_constants","_messages","_interopRequireDefault","e","__esModule","default","useFieldController","_ref","name","fieldName","value","fieldValue","errorMessages","formEditMode","activeFieldName","fieldRestrictions","savingErrors","formatMessage","useIntl","draftValue","setDraftValue","useState","fieldError","setFieldError","useEffect","required","min_length","length","messages","minLength","max_length","maxLength","Object","keys","isFieldBeingEdited","FORM_MODE","EDITING","getFieldDisplayMode","DEFAULT","_default","exports"],"sources":["../../../src/extended-profile/account-fields/useFieldController.js"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useIntl } from '@edx/frontend-platform/i18n';\nimport { FORM_MODE } from '../constants';\nimport messages from '../messages';\n\nconst useFieldController = ({\n  name: fieldName, value: fieldValue, errorMessages, formEditMode, activeFieldName, fieldRestrictions, savingErrors,\n}) => {\n  const { formatMessage } = useIntl();\n  const [draftValue, setDraftValue] = useState(fieldValue);\n  const [fieldError, setFieldError] = useState(null);\n\n  useEffect(() => {\n    if (draftValue === '') {\n      setFieldError(errorMessages.required);\n    } else if (fieldRestrictions?.min_length && draftValue?.length < fieldRestrictions.min_length) {\n      setFieldError(errorMessages?.min_length\n            ?? formatMessage(messages['profile.formcontrols.error.min_length'], { minLength: fieldRestrictions.min_length }));\n    } else if (fieldRestrictions?.max_length && draftValue?.length > fieldRestrictions.max_length) {\n      setFieldError(errorMessages?.max_length\n            ?? formatMessage(messages['profile.formcontrols.error.max_length'], { maxLength: fieldRestrictions.min_length }));\n    } else {\n      setFieldError(null);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [draftValue?.length]);\n\n  useEffect(() => {\n    setFieldError(savingErrors[fieldName]);\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [Object.keys(savingErrors).length]);\n\n  const isFieldBeingEdited = formEditMode === FORM_MODE.EDITING && activeFieldName === fieldName;\n\n  const getFieldDisplayMode = () => {\n    if (isFieldBeingEdited) {\n      return FORM_MODE.EDITING;\n    }\n    return FORM_MODE.DEFAULT;\n  };\n\n  return {\n    draftValue,\n    setDraftValue,\n    fieldError,\n    getFieldDisplayMode,\n  };\n};\n\nexport default useFieldController;\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,OAAA;AACA,IAAAC,KAAA,GAAAD,OAAA;AACA,IAAAE,UAAA,GAAAF,OAAA;AACA,IAAAG,SAAA,GAAAC,sBAAA,CAAAJ,OAAA;AAAmC,SAAAI,uBAAAC,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEnC,MAAMG,kBAAkB,GAAGC,IAAA,IAErB;EAAA,IAFsB;IAC1BC,IAAI,EAAEC,SAAS;IAAEC,KAAK,EAAEC,UAAU;IAAEC,aAAa;IAAEC,YAAY;IAAEC,eAAe;IAAEC,iBAAiB;IAAEC;EACvG,CAAC,GAAAT,IAAA;EACC,MAAM;IAAEU;EAAc,CAAC,GAAG,IAAAC,aAAO,EAAC,CAAC;EACnC,MAAM,CAACC,UAAU,EAAEC,aAAa,CAAC,GAAG,IAAAC,eAAQ,EAACV,UAAU,CAAC;EACxD,MAAM,CAACW,UAAU,EAAEC,aAAa,CAAC,GAAG,IAAAF,eAAQ,EAAC,IAAI,CAAC;EAElD,IAAAG,gBAAS,EAAC,MAAM;IACd,IAAIL,UAAU,KAAK,EAAE,EAAE;MACrBI,aAAa,CAACX,aAAa,CAACa,QAAQ,CAAC;IACvC,CAAC,MAAM,IAAIV,iBAAiB,EAAEW,UAAU,IAAIP,UAAU,EAAEQ,MAAM,GAAGZ,iBAAiB,CAACW,UAAU,EAAE;MAC7FH,aAAa,CAACX,aAAa,EAAEc,UAAU,IAC9BT,aAAa,CAACW,iBAAQ,CAAC,uCAAuC,CAAC,EAAE;QAAEC,SAAS,EAAEd,iBAAiB,CAACW;MAAW,CAAC,CAAC,CAAC;IACzH,CAAC,MAAM,IAAIX,iBAAiB,EAAEe,UAAU,IAAIX,UAAU,EAAEQ,MAAM,GAAGZ,iBAAiB,CAACe,UAAU,EAAE;MAC7FP,aAAa,CAACX,aAAa,EAAEkB,UAAU,IAC9Bb,aAAa,CAACW,iBAAQ,CAAC,uCAAuC,CAAC,EAAE;QAAEG,SAAS,EAAEhB,iBAAiB,CAACW;MAAW,CAAC,CAAC,CAAC;IACzH,CAAC,MAAM;MACLH,aAAa,CAAC,IAAI,CAAC;IACrB;IACA;EACF,CAAC,EAAE,CAACJ,UAAU,EAAEQ,MAAM,CAAC,CAAC;EAExB,IAAAH,gBAAS,EAAC,MAAM;IACdD,aAAa,CAACP,YAAY,CAACP,SAAS,CAAC,CAAC;IACxC;EACA,CAAC,EAAE,CAACuB,MAAM,CAACC,IAAI,CAACjB,YAAY,CAAC,CAACW,MAAM,CAAC,CAAC;EAEtC,MAAMO,kBAAkB,GAAGrB,YAAY,KAAKsB,oBAAS,CAACC,OAAO,IAAItB,eAAe,KAAKL,SAAS;EAE9F,MAAM4B,mBAAmB,GAAGA,CAAA,KAAM;IAChC,IAAIH,kBAAkB,EAAE;MACtB,OAAOC,oBAAS,CAACC,OAAO;IAC1B;IACA,OAAOD,oBAAS,CAACG,OAAO;EAC1B,CAAC;EAED,OAAO;IACLnB,UAAU;IACVC,aAAa;IACbE,UAAU;IACVe;EACF,CAAC;AACH,CAAC;AAAC,IAAAE,QAAA,GAAAC,OAAA,CAAAnC,OAAA,GAEaC,kBAAkB","ignoreList":[]}