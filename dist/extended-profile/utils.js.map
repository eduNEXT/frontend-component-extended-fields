{"version":3,"file":"utils.js","names":["moveCheckboxFieldsToEnd","a","b","type","exports","adaptField","field","exposed","required","arguments","length","undefined","_objectSpread","name","label","defaultValue","default","placeholder","instructions","restrictions","errorMessages","error_message","supplementalLink","supplementalText","loginIssueSupportLink","options","Array","isArray","map","_ref","value","adaptFields","_ref2","registrationFields","optionalFields","allFieldNames","Object","keys","fields","uniqueFieldNames","Set","fieldName","extended_profile","includes"],"sources":["../../src/extended-profile/utils.js"],"sourcesContent":["/**\n * Sort fields so that checkbox fields are at the end of the list.\n * @param {object} a the first field to compare\n * @param {object} b the second field to compare\n * @returns a negative integer if a should come before b, a positive integer\n * if a should come after b, or 0 if a and b have the same order\n */\nexport const moveCheckboxFieldsToEnd = (a, b) => {\n  if (a?.type === 'checkbox' && b?.type !== 'checkbox') {\n    return 1;\n  }\n  if (a?.type !== 'checkbox' && b?.type === 'checkbox') {\n    return -1;\n  }\n  return 0;\n};\n\nfunction adaptField(field, { exposed = true, required = true } = {}) {\n  return {\n    name: field.name,\n    label: field.label,\n    type: field.type,\n    defaultValue: field.default ?? null,\n    placeholder: field.placeholder ?? null,\n    instructions: field.instructions ?? '',\n    exposed,\n    required,\n    restrictions: field.restrictions ?? {},\n    errorMessages: field.error_message ?? {},\n    supplementalLink: '',\n    supplementalText: '',\n    loginIssueSupportLink: '',\n    ...(field.options && {\n      options: Array.isArray(field.options)\n        ? field.options.map(([value, name]) => ({\n          value,\n          name,\n          default: false,\n        }))\n        : undefined,\n    }),\n  };\n}\n\nexport function adaptFields({ registrationFields, optionalFields }) {\n  // Merge all field keys from both sources\n  const allFieldNames = [...Object.keys(registrationFields.fields), ...Object.keys(optionalFields.fields)];\n  // Deduplicate\n  const uniqueFieldNames = [...new Set(allFieldNames)];\n\n  return uniqueFieldNames.map((fieldName) => {\n    // Prefer registrationFields, fallback to optionalFields\n    const field = registrationFields.fields[fieldName] || optionalFields.fields[fieldName];\n\n    // Determine if field is exposed (in optionalFields.extended_profile)\n    const exposed = optionalFields.extended_profile && optionalFields.extended_profile.includes(fieldName);\n\n    // Required: if error_message.required exists and is non-empty\n    const required = !!(\n      field.error_message\n   && (typeof field.error_message === 'string' ? field.error_message : field.error_message.required)\n    );\n\n    return adaptField(field, { exposed, required });\n  });\n}\n"],"mappings":"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","ignoreList":[]}